---
title: "Abraham Wald et les trous de balles manquants."
subtitle: "encore une présentation sur la Seconde Guerre Mondiale..."
author: "Marc-André Désautels"
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
library(knitr)
opts_chunk$set(fig.retina = 3, warning = FALSE, message = FALSE)
options(htmltools.dir.version = FALSE)
library(tidyverse)
library(kableExtra)
```

class: inverse, middle

## *This story, like many World War II stories, start with the Nazis hounding a Jew out of Europe and ends with the Nazis regretting it.*

### Jordan Ellenberg

---

class: center, middle

.center[
<img src="https://media.giphy.com/media/k5DmEDkonEpVu/giphy.gif" width=80%>
]

---
class: inverse, center, middle

# La jeunesse

---

# Abraham Wald

.pull-left[

- Né le 31 octobre 1902 à Cluj-Napoca en Roumanie

- En 1927, il entre à l'université de Vienne (Autriche) où il reçoit un doctorat en mathématiques en 1931, sous la direction de Karl Menger

- À la fin de ses études, en raison de la discrimination de l'Autriche face aux Juifs, il ne parvient pas à se trouver un emploi

]
.pull-right[

.center[

![Un jeune Abraham Wald](https://upload.wikimedia.org/wikipedia/en/0/05/Abraham_Wald_in_his_youth.jpg)

]

]

---

# Abraham Wald

- Il se fait offrir un emploi en économie par Oskar Morgenstern (celui-ci émigre plus tard aux États-Unis et aide à inventer la thérie des jeux)

- Malgré la situation politique qui se dégrade en Autriche, Wald hésite à émigrer

- Mais les Nazis envahissent l'Autriche en 1938 et Wald part aux États-Unis avec sa famille

- Grâce à son expérience en économie, il reçoit une bourse pour travailler pour la *Cowles Commision for Research in Economics* un institut basé au Colorado

- Il se fait finalement offrir un emploi de professeur de statistiques à l'université Columbia, à New-York

--

### C'est à partir de ce moment qu'il commence à participer à l'effort de guerre...

???

Despite Wald's brilliance, he could not obtain a university position, because of Austrian discrimination against Jews. However, Oskar Morgenstern created a position for Wald in economics. When the Nazis invaded Austria in 1938, the discrimination against Jews intensified. In particular, Wald and his family were persecuted as Jews. Wald was able to emigrate to the United States, at the invitation of the Cowles Commission for Research in Economics, to work on econometrics research

---
layout: false
class: center, inverse, middle

# Le *Statistical Research Group* (SRG)
# 1942-1945

---

### Le *Statistical Research Group* (SRG)

--

- Le SRG était basé à l'université Columbia et supporté par le *Applied Mathematics Panel* (AMP) du *National Defense Research Committee* (NDRC), qui faisait partie du *Office of Scientific Research and Development* (OSRD)

--

- Le SRG était un programme secret formé de statisticiens, un peu comme le projet Manhattan mais fabriquant des équations plutôt que des bombes

--

- *[...] when we made recommendations, frequently things happened.* W. Allen Wallis

--

- *Fighter planes entered combat with their machine guns loaded according to Jack Wolfowitz's recommendations about mixing types of ammunition, and maybe the pilots came back or maybe they didn't.*

--

- *Navy planes launched rockets whose propellants had been accepted by Abe Girshick's sampling-inspection plans, and maybe the rockets exploded and destroyed our own planes and pilots or maybe they destroyed the targe*

---

### Le *Statistical Research Group* (SRG)

--

- *SRG was composed of what surely must be the most extraordinary group of statisticians ever organized, taking into account both number and quality.* W. Allen Wallis

--

- **Wilson Allen Wallis** (5 novembre 1912 - 12 octobre 1998), directeur du SRG, économiste et statisticien. Il a développé le test Kruskal-Wallis avec William Kruskal

--

- **Milton Friedman** (31 juillet 1912 - 16 novembre 2006), économiste. Prix Nobel d'économie en 1976 pour ses travaux sur l'analyse de la consommation, l'histoire monétaire et la démonstration de la complexité des politiques de stabilisation

--

- **George Stigler** (17 janvier 1911 - 1er décembre 1991), économiste. Prix Nobel d'économie en 1982 pour ses études fondatrices des structures industrielles, du fonctionnement des marchés, et des causes et effets de la régulation publique

--

- et j'en passe...

---
class: center, inverse, middle

# Les mathématiques

--

## Les trous de balles manquants

---

class: middle

.center[
<img src="https://media.giphy.com/media/lVzju3EudcLS0/giphy.gif" width=90%>
]

---

### Les trous de balles manquants

**Question**: Vous ne voulez pas que vos avions soient abattus par des tirs ennemis, vous décidez donc de leur ajouter du blindage. Mais du blindage alourdit vos avions, les rend moins manoeuvrables et ceux-ci utilisent davantage de carburant.

--

- Mettre trop de blindage est un problème

--

- Ne pas mettre assez de blindage est un problème

--

### Que faire???

---

### Les trous de balles manquants

.center[![avion troué](https://res.cloudinary.com/dzawgnnlr/image/upload/q_auto/f_auto/w_auto/bullet-riddled-plane.jpg)]

Les avions revenaient du combat couverts de trous de balles, mais les trous n'étaient pas uniformément distribués sur tout l'avion.

---

background-image: url(https://upload.wikimedia.org/wikipedia/commons/thumb/9/98/Survivorship-bias.png/1024px-Survivorship-bias.png)
background-size: cover

---

### Les trous de balles manquants

Les officiers de l'armée y ont vu une opportunité d'efficacité.

Obtenir la même protection avec moins de blindage, si on se concentre sur les endroits en ayant davantage besoin.

Ils demandèrent à Wald quelle quantité de blindage ajouter aux divers parties de l'avion.

--

#### **Question: Quelles sont les parties de l'avion nécessitant la plus grande quantité de blindage?**

|            Section de l'avion           | Nombre de trous par pieds carrés |
|-----------------------------------------|----------------------------------|
| Moteur                                  | 1,11                             |
| Fuselage (partie principale de l'avion) | 1,73                             |
| Système de carburant                    | 1,55                             |
| Reste de l'avion                        | 1,8                              |

--

### Vous pouvez voter à l'adresse: [http://bit.ly/TrousBalles](http://bit.ly/TrousBalles)

---
### Les résultats

<iframe seamless src="https://docs.google.com/spreadsheets/d/1tgbKRrHQnyDP2lvgH5iQhrxLG75C3TafKSjFwmVEqkM/htmlembed/sheet?gid=1284962309&range=D2" width="800" height="500" frameborder="0" scrolling="no"></iframe>

---

### Les trous de balles manquants

Wald indiqua que le blindage ne devait pas aller aux endroits **où il avait des trous**. Il devait aller aux endroits **où il n'y en avait pas**.

--

- Le raisonnement de Wald était le suivant: où sont les trous manquants?

--

- Les trous manquants sont sur les avions qui ne sont pas revenus.

--

- La raison pour laquelle les avions de retour avaient moins de trous dans la région des moteurs était que les avions ayant été touchés aux moteurs ne revenaient pas.

--

- Comment est-ce que Wald a pu voir ce que les officiers expérimentés de l'armée ne pouvaient pas voir?

---

### Les trous de balles manquants

- Un statisticien se pose toujours la question suivante: Quelles sont les hypothèses que vous faites? Sont-elles justifiées?

--

- Les officiers de l'armée étaient sous l'impression que les avions qui revenaient formaient un échantillon aléatoire de tous les avions.

--

- Une fois que vous avez compris que c'est l'hypothèse sous laquelle vous travaillez, ça prend un petit moment pour comprendre que vous faites fausse route.

---

## Concernant Abraham Wald

> *The military was inclined to provide protection for those parts that on returning planes showed the most hits. Wald assumed, on good evidence, that hits in combat were uniformly distributed over the planes. It follows that hits on the more vulnerable parts were less likely to be found on returning planes than hits on the less vulnerable parts, since planes receiving hits on the more vulnerable parts were less likely to return to provide data. From these premises, he devised methods for estimating vulnerability of various parts.*

---

class: middle

.center[
<img src="https://i.gifer.com/36jI.gif" width=90%>
]


---
class: inverse, center middle

## Le biais du survivant

--

### Une forme de biais de sélection consistant à surévaluer les chances de succès d'une initiative en concentrant l'attention sur les sujets ayant réussi mais qui sont des exceptions statistiques (des « survivants ») plutôt que des cas représentatifs.

---

### Quelques exemples

--

- En finance, le biais du survivant survient lors de l'exclusion des entreprises ayant fait faillite des études de performance.

--

- En production industrielle, on entend souvent « les produits étaient mieux fabriqués avant ».

--

- En architecture et en construction, les bâtiments de plus de 100 ans encore debout.

--

- Dans les carrières hypercompétitives, commes les athlètes d'élite.

--

- Une étude réalisée en 1987 montre que les chats qui chutent d'une hauteur équivalente à moins de six étages et qui survivent ont des blessures plus graves que les chats tombant d'une hauteur plus élevée.

???

La situation pourrait cependant s'expliquer par un biais du survivant. Il est beaucoup moins probable que les chats qui meurent à la suite d'une chute soient emmenés chez le vétérinaire par rapport aux chats blessés par une chute. Les chats morts à la suite d'une chute de plus de six étages sont donc retirés des statistiques, ne laissant la place qu'aux chats « survivants ».

WO Whitney et CJ Mehlhaff, *Journal of the American Veterinary Medical Association* **191**, 1 399-1 403, 1987

---

class: inverse, center, middle

# La navette Challenger

---

background-image: url(https://natgeo.imgix.net/factsheets/thumbnails/ChallengerDisaster.jpg?auto=compress,format&w=1024&h=560&fit=crop)
background-size: cover

---

background-image: url(https://upload.wikimedia.org/wikipedia/commons/3/3f/Challenger_flight_51-l_crew.jpg)
background-size: cover

???

STS-51-L crew: (front row) Michael J. Smith, Dick Scobee, Ronald McNair; (back row) Ellison Onizuka, Christa McAuliffe, Gregory Jarvis, Judith Resnik

---

background-image: url(https://img2.thejournal.ie/inline/2573246/original/?width=630&version=2573246)
background-size: cover

---

# Challenger

--

- Le désastre de la navette Challenger s'est déroulé le 28 janvier 1986.

--

- La navette se brisa et se désintégra après 73 secondes de vol.

--

- L'accident choqua énormément la société américaine, en partie en raison de la présence de Christa McAuliffe, qui aurait été la première astronaute-enseignante.

--

- Une des conséquences de cet accident est la mise sur pied de la *Rogers Commission* (formé par Neil A. Armstrong et le prix Nobel Richard P. Feynman, entre autre).

--

- Cette commission conclut que la désintégration est causée par l'échec d'un joint d'étanchéité en raison des températures inhabituellements froides.

--

### Le problème des joints d'étanchéité était connu!

---

### Les données concernant les joints d'étanchéité

```{r nasa, echo=FALSE, tidy=FALSE}
nasa <- tibble(
  Flight =c("51-C","41-B","61-C","41-C","1","6","51-A","51-D","5","3","2","9","41-D","51-G","7","8","51-B","61-A","51-I","61-B","41-G","51-J",NA,"51-F"),
  Date = c("1985-01-24","1984-02-03","1986-01-12","1984-04-06","1981-04-12","1983-04-04","1984-11-08","1985-04-12","1982-11-11","1982-03-22","1981-11-12","1983-11-28","1984-08-30","1985-06-17","1983-06-18","1983-08-30","1985-04-29","1985-10-30","1985-08-27","1985-11-26","1984-10-05","1985-10-03","1982-06-27","1985-07-29"),
  Temperature = c(53,57,58,63,66,67,67,67,68,69,70,70,70,70,72,73,75,75,76,76,78,79,80,81),
  Erosion = c(2,1,1,1,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0),
  Blowby = c(2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0),
  Total = 6,
  DamageIndex = c(11,4,4,2,0,0,0,0,0,0,4,0,4,0,0,0,0,4,0,0,0,0,NA,0),
  Comments = c("Most erosion any flight; blow-by; back-up rings heated.",
               "Deep, extensive erosion.",
               "O-ring erosion on launch two weeks before Challenger.",
               "O-rings showed signs of heating, but no damage.",
               "Coolest (66 degrees) launch withouth O-rings problems.",
               "None","None","None","None","None",
               "Extent of erosion not fully known",
               "None","None","None","None","None","None",
               "No erosion. Soot found behind two primary O-rings.",
               "None","None","None","None",
               "O-ring condition unknown; rocket casing lost at sea.",
               "None")
)
```

```{r, echo=FALSE}
nasa %>% 
  kable(format = "html") %>% 
  kable_styling(font_size = 12) %>% 
  scroll_box(width = "100%", height = "80%")
```

---

### Les joints d'étanchéité

```{r, echo=FALSE}
nasa <- nasa %>% 
  mutate(
    ErosionOrBlowby = if_else(Erosion >= Blowby, Erosion, Blowby),
    Incident = if_else(DamageIndex > 0, 1, 0),
    Celsius = (Temperature-32)*5/9,
    NumberJoints = 6
  )
```

La nuit avant le décollage, une téléconférence a eue lieu entre les ingénieurs, les directeurs de la NASA, pour discuter des effets des basses températures sur le décollage et les joints d'étanchéité.

--

> *Temperature data [are] not conclusive on predicting primary O-ring blowby.*

--

```{r, echo = FALSE, fig.align='center', fig.height = 5}
nasa %>% 
  filter(!is.na(DamageIndex) & DamageIndex > 0) %>% 
  ggplot(aes(x = Celsius, y = ErosionOrBlowby)) +
  geom_jitter(width = 0, height = 0.1) +
  scale_x_continuous(name = "Température en degrés Celsius", limits = c(-5,30), breaks = seq(-5,30,5))  +
  scale_y_continuous(name = "Nombre d'incidents", limits = c(-0.5,2.5), breaks = seq(0,2,1))
```

???

La conclusion a été fortement influencée par la figure ci-dessous.

---

### Les joints d'étanchéité

--

La commission Rogers trouva une grave erreur dans la figure précédente, **les vols sans aucuns incidents avaient été exclus** du graphique car *on croyait* que **ces vols ne contribuaient aucune information sur l'effet de la température**.

--

> *A careful analysis of the flight history of O-ring performance would have revealed the correlation of O-ring damage in low temperature*

--

```{r, echo = FALSE, fig.align='center', fig.height = 5}
nasa %>% 
  filter(!is.na(DamageIndex) & DamageIndex >= 0) %>% 
  ggplot(aes(x = Celsius, y = ErosionOrBlowby)) +
  geom_jitter(width = 0, height = 0.1) +
  scale_x_continuous(name = "Température en degrés Celsius", limits = c(-5,30), breaks = seq(-5,30,5))  +
  scale_y_continuous(name = "Nombre d'incidents", limits = c(-0.5,2.5), breaks = seq(0,2,1))
```

---

### Une régression logistique

```{r, echo = FALSE, fig.align='center', fig.height = 7, fig.width = 9}
challenger <- nasa %>% 
  filter(!is.na(DamageIndex) & DamageIndex >= 0) %>% 
  ggplot(aes(x = Celsius, y = ErosionOrBlowby)) +
  geom_point() +
  scale_x_continuous(name = "Température en degrés Celsius", limits = c(-5,30), breaks = seq(-5,30,5))  +
  scale_y_continuous(name = "Nombre d'incidents", limits = c(0,6), breaks = seq(0,6,1))
challenger.glm <- glm(ErosionOrBlowby/NumberJoints ~ Celsius, data=nasa, family=binomial, weights = NumberJoints)
alpha <- coef(challenger.glm)[1]
beta <- coef(challenger.glm)[2]
incidents <- function(x) 6/(1+exp(-alpha-beta*x))
challenger
```

---

### Une régression logistique

```{r, echo = FALSE, fig.align='center', fig.height = 7, fig.width = 9}
challenger +
  geom_vline(xintercept = (26-32)*5/9, color = "red", size = 1) +
  geom_vline(xintercept = (29-32)*5/9, color = "red", size = 1) +
  geom_text(x = 1, y = 0, label = "Challenger", color = "red")
```

---

### Une régression logistique

```{r, echo = FALSE, fig.align='center', fig.height = 7, fig.width = 9}
challenger +
  geom_vline(xintercept = (26-32)*5/9, color = "red", size = 1) +
  geom_vline(xintercept = (29-32)*5/9, color = "red", size = 1) +
  geom_text(x = 1, y = 0, label = "Challenger", color = "red") +
  stat_function(fun = incidents, colour = "blue")
```

---

class: middle

.center[
<img src="https://media.giphy.com/media/lVzju3EudcLS0/giphy.gif" width=90%>
]

---
class: center, inverse, middle

# Les mathématiques

### La vulnérabilité des avions

---

### Quelques notations

$N$ : le nombre d'avions au total.

$N_i$ : le nombre d'avions au total touchés $i$ fois.

$S$ : le nombre d'avions survivants.

$S_i$ : le nombre d'avions survivants touchés $i$ fois.

$D$ : le nombre d'avions disparus.

$D_i$ : le nombre d'avions disparus touchés $i$ fois.

$P_i$ : la probabilité qu'un avion soit abattu par $i$ coups au but.

$Q_i=1-P_i$ : la probabilité de l'événement contraire.

$p_i$ : la probabilité conditionnelle qu'un avion soit abattu par le $i$ème coup au but, étant donné que les premiers $i-1$ coups ne l'ont pas abattu.

$q_i=1-p_i$ : la probabilité de l'événement contraire.

---

### Quelques résultats « évidents »

--

- Le nombre total d'avions envoyés au combat est égal à la somme des avions survivants et des avions disparus, c'est-à-dire que $N = S+D$. Nous utiliserons habituellement $D = N - S$.

--

- De façon similaire, en étudiant les avions touchés au but $i$ fois, nous avons $N_i = S_i+D_i$.

--

- La probabilité qu'un avion ne soit pas abattu par $i$ coups au but est en fait la probabilité de ne pas être abattu par 1 coup (en ayant survécu aux coups précédents) et de ne pas être abattu par 2 coups (en ayant survécu aux coups précédents), ... et de ne pas être abattu par $i$ coups (en ayant survécu aux coups précédents). Nous avons donc $Q_i = q_1 q_2 \ldots q_i$.

--

- La probabilité d'être abattu par $i$ coups au but est donc $P_i = 1-Q_i = 1 - q_1 q_2 \ldots q_i$.

---

### Les hypothèses

- Nous connaissons $N$.

- Nous connaissons pour tout $i$ ( $i=0,1,2,\ldots$ ) les nombres $S_i$.

- Nous supposons que tous les avions disparus le sont en raison de tirs ennemis et donc $D_0=0$. Ceci implique que nous supposons qu'aucun avion ne peut être porté disparu en raison de problèmes mécaniques.

- Le nombre de tirs sur un avion est borné, c'est-à-dire que $D_j=0$ pour $j$ plus grand qu'un certain entier $m$.

- Pour simplifier la notation, nous écrirons $N_{j\geq i}$ pour signifier $\sum\limits_{j\geq i}N_j$.

---

Rappelons que $p_i$ représente la probabilité conditionnelle qu'un avion soit abattu par le $i$ème coup au but, étant donné que les premiers $i-1$ coups ne l'ont pas abattu. Nous pouvons donc écrire $p_i=\frac{D_i}{N_{j\geq i}}$. 

Nous avons donc:

$$\begin{eqnarray*} 
D_i &=& p_i \left( N_{j\geq i} \right) \\
&=& p_i \left( N - N_{j< i} \right) \\
&=& p_i \left( N - S_{j< i} - D_{j< i} \right)
\end{eqnarray*}$$

L'idée géniale de Wald est de se rendre compte que nous pouvons résoudre l'équation précédente par induction sur $i$ car nous savons que $D_0=0$. Ainsi:

$$\begin{eqnarray*} 
D_0 &=& 0 \\
D_1 &=& p_1 \left( N - S_{j< 1} - D_{j< 1} \right) \\
&=& p_1 \left( N - S_{0} \right) \\
D_2 &=& p_2 \left( N - S_{j< 2} - D_{j< 2} \right) \\
&=& p_2 \left( N - S_0 - S_1 - D_1 \right) \\
& \ldots &
\end{eqnarray*}$$

---

### Comment trouver les $p_i$?

L'équation précédente nous ramène maintenant à la question de trouver les valeurs des $p_i$. 

En vérité, il n'est pas possible de les trouver, mais Wald parvient à trouver divers estimés.

Pour ce faire, il utilise l'équation suivante:

$$ \sum_{j=1}^m \frac{S_j}{q_1q_2 \ldots q_j} = N-S_0$$
